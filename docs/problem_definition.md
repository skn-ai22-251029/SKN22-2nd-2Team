# EPIC 1. 문제 정의 및 예측 프레임 설정

본 문서는 가입 고객 이탈 예측 프로젝트에서 **EPIC 1의 결정 사항을 최종 확정**하기 위한 문서이다.  
EPIC 1은 데이터 탐색이나 모델 학습 단계가 아니며, 이후 모든 전처리, 피처 생성, 모델 학습 및 평가 단계에 **변경 불가능한 기준**으로 적용된다.

본 문서의 모든 정의는 **KKBox Churn Prediction 데이터셋에 실제로 포함된 정보만**을 근거로 한다.

---

## 1. 예측 문제 정의

본 프로젝트의 예측 문제는 다음과 같이 정의한다.

- 문제 유형: 이진 분류(Binary Classification)
- 타겟 변수: `train_v2.is_churn`
  - `1`: churn
  - `0`: non-churn
- 예측 목표:
  - 특정 시점 T에서, 해당 사용자가 **이후에 이탈했는지 여부**를 예측한다.

---

## 2. 데이터셋 기반 시간 제약

본 데이터셋에서 관측 가능한 로그 데이터의 실제 기간은 다음과 같다.

- `user_logs_v2.date`: **2017-03-01 ~ 2017-03-31**

따라서 사용자 행동 로그를 활용한 관측은 위 기간을 벗어날 수 없으며,  
관측 윈도우의 최대 길이는 **30일**로 제한된다.

---

## 3. 예측 시점 (Prediction Time, T)

### 정의
예측 시점 T란,
> “이 시점까지의 정보만을 사용하여 예측을 수행한다”라고 가정하는 기준 시점이다.

### 본 프로젝트에서의 설정
- 예측 시점 T: **2017-04-01**

### 적용 규칙
- 모든 feature는 반드시 **T 이전 데이터만** 사용하여 생성한다.
- T 이후 데이터는 어떤 경우에도 feature로 사용하지 않는다.

---

## 4. 관측 윈도우 (Observation Window)

### 정의
관측 윈도우란,
> 예측 시점 T 이전의 일정 기간 동안의 데이터를 의미하며,  
> 해당 구간의 데이터를 집계하여 feature를 생성한다.

### 본 프로젝트에서의 설정
- 관측 윈도우: **2017-03-01 ~ 2017-03-31 (30일)**

### 적용 대상
- `user_logs_v2`
- `transactions_v2` (T 이전 기록만 사용)

관측 윈도우 밖의 로그 및 거래 데이터는 feature 생성에 사용하지 않는다.

---

## 5. 예측 윈도우 (Prediction Window)

### 정의
예측 윈도우란,
> 예측 시점 T 이후에 이탈이 발생했는지를 판단하는 기간이다.

### 본 프로젝트에서의 해석
- 예측 윈도우는 **T 이후의 기간 전체**를 의미한다.
- 해당 기간 동안의 이탈 여부는 `train_v2.is_churn` 라벨에 이미 반영되어 있다.
- 데이터셋에는 예측 윈도우의 **정확한 기간 길이(일수)**가 명시되어 있지 않다.

따라서 본 프로젝트에서는 예측 윈도우의 길이를 별도로 정의하지 않고,  
제공된 churn 라벨을 그대로 사용한다.

---

## 6. 관측 윈도우 밖 데이터 사용 원칙

### 원칙
- 관측 윈도우 밖의 로그 데이터와 거래 데이터는 **feature 생성에 사용하지 않는다**.

이는 다음 이유에 따른다.
- 사용자별 데이터 길이 불균형 방지
- 최근 행동 패턴 중심의 예측 유지
- 실제 운영 환경과의 일관성 확보

### 허용되는 예외 (정적 정보)
다음 정보는 시간에 독립적인 정적 속성으로 간주하여 사용을 허용한다.

- `members_v3.gender`
- `members_v3.registered_via`
- `members_v3.registration_init_time`
  - 단, T 기준으로 **가입 후 경과 일수** 형태로 변환하여 사용한다.

---

## 7. 조인 및 데이터 구성 원칙

- 기준 테이블은 항상 `train_v2`이다.
- 최종 학습 데이터는 **1 user = 1 row** 구조를 유지한다.
- 모든 외부 테이블은 `LEFT JOIN`으로 병합한다.
- 관측 윈도우 내 데이터가 없는 경우:
  - row를 제거하지 않는다.
  - 해당 feature 값은 0 또는 명시적인 결측값으로 처리한다.
  - 이는 “최근 30일간 활동 없음”이라는 의미 있는 신호로 해석한다.

---

## 8. EPIC 1 결정 사항 요약

본 문서에서 다음 사항을 최종 확정한다.

- 예측 문제 정의 및 타겟 변수(`is_churn`)
- 예측 시점 T = 2017-04-01
- 관측 윈도우 = 2017-03-01 ~ 2017-03-31 (30일)
- 예측 윈도우는 T 이후 결과이며, 라벨에 이미 반영됨
- 관측 윈도우 밖 로그/거래 데이터 사용 금지
- 정적 정보에 한한 예외 허용
- 조인 전략 및 데이터 구성 원칙

본 문서 이후 단계에서는 위 기준을 변경하지 않는다.
